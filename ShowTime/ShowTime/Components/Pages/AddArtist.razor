@page "/addartist"
@using ShowTime.BusinessLogic.Abstractions
@using ShowTime.BusinessLogic.Dtos
@inject IArtistService ArtistService

<MudContainer Class="py-8">
    <MudCard Style="max-width: 600px; margin: 0 auto;">
        <MudCardContent>
            <MudText Typo="Typo.h4" Class="mb-6" Style="color: #6a1b9a;">Add New Artist</MudText>
            
            <EditForm Model="newArtist" OnValidSubmit="AddArtistInList">
                <MudTextField @bind-Value="newArtist.Name" 
                              Label="Artist Name" 
                              Required="true"
                              RequiredError="Name is required"
                              Class="mb-4"/>
                
                <MudTextField @bind-Value="newArtist.Genre" 
                              Label="Genre" 
                              Required="true"
                              RequiredError="Genre is required"
                              Class="mb-4"/>
                
                <MudTextField @bind-Value="newArtist.Image" 
                              Label="Image URL" 
                              Class="mb-6"
                              HelperText="Paste a direct image link"/>
                
                <div class="d-flex justify-end gap-4">
                    <MudButton Variant="Variant.Text" 
                               Color="Color.Default">
                        Cancel
                    </MudButton>
                    <MudButton Variant="Variant.Filled" 
                               Color="Color.Primary" 
                               ButtonType="ButtonType.Submit"
                               Disabled="@(!IsFormValid)">
                        Add Artist
                    </MudButton>
                </div>
            </EditForm>
        </MudCardContent>
    </MudCard>
</MudContainer>
@code {
    [SupplyParameterFromForm]
    private ArtistCreateDto newArtist { get; set; } = new();
    
    private bool IsFormValid => 
        !string.IsNullOrWhiteSpace(newArtist.Name) &&
        !string.IsNullOrWhiteSpace(newArtist.Genre);
    
    private async Task AddArtistInList()
    {
        await ArtistService.AddArtistAsync(newArtist);
        newArtist = new();
    }
}